{
  "active": false,
  "connections": {
    "Trigger cada minuto": {
      "main": [
        [
          {
            "node": "Buscar √∫ltimas filas Airtable",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Buscar √∫ltimas filas Airtable": {
      "main": [
        [
          {
            "node": "Crear documento en Google Docs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear documento en Google Docs": {
      "main": [
        [
          {
            "node": "Mover a carpeta de albaranes",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mover a carpeta de albaranes": {
      "main": [
        [
          {
            "node": "Enviar albar√°n por Gmail",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Enviar albar√°n por Gmail": {
      "main": [
        [
          {
            "node": "Actualizar registro en Airtable",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-08-02T21:04:58.725Z",
  "id": "03DsXpuG4sBiItJW",
  "isArchived": true,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "My workflow 6",
  "nodes": [
    {
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        }
      },
      "id": "65942cc7-c020-44f4-b80a-648dac953b8f",
      "name": "Trigger cada minuto",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [
        656,
        160
      ]
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "app1YHusrevWB1mhd",
          "mode": "list",
          "cachedResultName": "MC Store Management",
          "cachedResultUrl": "https://airtable.com/app1YHusrevWB1mhd"
        },
        "table": {
          "__rl": true,
          "value": "tbldjfoFncKY1j3Qy",
          "mode": "list",
          "cachedResultName": "Pedidos de Clientes",
          "cachedResultUrl": "https://airtable.com/app1YHusrevWB1mhd/tbldjfoFncKY1j3Qy"
        },
        "options": {}
      },
      "id": "c4b02c49-01a8-46e2-9ee6-1c5c61c5aba3",
      "name": "Buscar √∫ltimas filas Airtable",
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        864,
        160
      ],
      "credentials": {
        "airtableTokenApi": {
          "id": "fYikZL9kIA4GSbSE",
          "name": "MC Store - n8n"
        }
      }
    },
    {
      "parameters": {
        "folderId": "1L2-1XdcwUGAsw350BoDL9IpTlsrI06GG",
        "title": "={{ 'Albar√°n ' + $json.numeroAlbaran + ' - ' + $json.datosCliente.cliente }}"
      },
      "id": "658a4663-cf98-47ae-b468-1a595a925abf",
      "name": "Crear documento en Google Docs",
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        1744,
        80
      ],
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "jdL6gIsT7wmlfMOw",
          "name": "Google Docs Joel"
        }
      }
    },
    {
      "parameters": {
        "operation": "move",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.documentId }}",
          "mode": "id"
        },
        "driveId": {
          "__rl": true,
          "value": "My Drive",
          "mode": "list",
          "cachedResultName": "My Drive",
          "cachedResultUrl": "https://drive.google.com/drive/my-drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1Pikucw4niEkjaZOOxJ_BM3imYyLEsWbB",
          "mode": "list",
          "cachedResultName": "PRUEBAS MC STORE",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1Pikucw4niEkjaZOOxJ_BM3imYyLEsWbB"
        }
      },
      "id": "ff62835e-aeb1-438f-8b55-7bca47b8034c",
      "name": "Mover a carpeta de albaranes",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1968,
        80
      ],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tBOmezIuyakBr2dl",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "=jimenolmo91@gmail.com",
        "subject": "={{ 'Albar√°n ' + $('Generar contenido del albar√°n').item.json.numeroAlbaran + ' - Entrega confirmada' }}",
        "message": "=Estimado/a {{ $('Generar contenido del albar√°n').item.json.datosCliente.cliente }},<br><br>Adjuntamos el albar√°n correspondiente a su pedido.<br><br>N√∫mero de albar√°n: {{ $('Generar contenido del albar√°n').item.json.numeroAlbaran }}<br>Fecha: {{ $('Generar contenido del albar√°n').item.json.fechaGeneracion }}<br><br>Puede acceder al documento completo en el siguiente enlace:<br><a href=\"https://docs.google.com/document/d/{{ $json.documentId }}\">Ver Albar√°n</a><br><br>Gracias por su confianza.<br><br>Saludos cordiales",
        "options": {}
      },
      "id": "9ffbb2e6-e623-4b79-85d7-7a17fc312c6d",
      "name": "Enviar albar√°n por Gmail",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2192,
        80
      ],
      "webhookId": "de36833b-5382-48dd-ad48-9796789ac794",
      "credentials": {
        "gmailOAuth2": {
          "id": "DqjqwrJcrjNZM2jb",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app1YHusrevWB1mhd",
          "mode": "list",
          "cachedResultName": "MC Store Management",
          "cachedResultUrl": "https://airtable.com/app1YHusrevWB1mhd"
        },
        "table": {
          "__rl": true,
          "value": "tbldjfoFncKY1j3Qy",
          "mode": "list",
          "cachedResultName": "Pedidos de Clientes",
          "cachedResultUrl": "https://airtable.com/app1YHusrevWB1mhd/tbldjfoFncKY1j3Qy"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Attachments": [
              {
                "url": "={{ 'https://docs.google.com/document/d/' + $('Mover a carpeta de albaranes').item.json.documentId }}",
                "filename": "={{ 'Albaran_' + $('Generar contenido del albar√°n').item.json.numeroAlbaran + '.pdf' }}"
              }
            ],
            "Estado": "Albar√°n Generado",
            "NumeroAlbaran": "={{ $('Generar contenido del albar√°n').item.json.numeroAlbaran }}",
            "FechaAlbaran": "={{ $('Generar contenido del albar√°n').item.json.fechaGeneracion }}"
          }
        },
        "options": {}
      },
      "id": "81942f34-ffda-4cca-b308-8f65e95062cc",
      "name": "Actualizar registro en Airtable",
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2416,
        80
      ],
      "credentials": {
        "airtableTokenApi": {
          "id": "fYikZL9kIA4GSbSE",
          "name": "MC Store - n8n"
        }
      }
    },
    {
      "parameters": {
        "content": "## üéØ CONFIGURACI√ìN INICIAL REQUERIDA\n\n**IMPORTANTE:** Antes de activar este flujo, debes configurar:\n\n1. **Credenciales de Airtable:**\n   - Obt√©n tu API Token desde https://airtable.com/account\n   - Configura las credenciales en n8n\n\n2. **IDs de Airtable:**\n   - `YOUR_AIRTABLE_BASE_ID`: ID de tu base de Airtable\n   - `YOUR_TABLE_NAME`: Nombre de tu tabla\n\n3. **Credenciales de Google:**\n   - Configura OAuth2 para Google Docs, Drive y Gmail\n   - Autoriza los permisos necesarios\n\n4. **IDs de Google Drive:**\n   - `YOUR_FOLDER_ID`: Carpeta temporal para crear documentos\n   - `YOUR_ALBARAN_FOLDER_ID`: Carpeta final para almacenar albaranes\n\n**‚úÖ VALIDACI√ìN COMPLETADA:**\n- Flujo estructurado correctamente\n- Conexiones v√°lidas entre nodos\n- 8 conexiones principales verificadas\n- Trigger configurado cada minuto",
        "height": 656,
        "width": 464
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        384,
        -528
      ],
      "id": "39a89c7c-0b58-4b3d-b3f1-fc32203ba79a",
      "name": "Configuraci√≥n Inicial"
    },
    {
      "parameters": {
        "content": "## ‚öôÔ∏è CAMPOS ESPERADOS EN AIRTABLE\n\n**Tu tabla debe contener estos campos:**\n- `Created` (fecha/hora de creaci√≥n) - **OBLIGATORIO**\n- `Cliente` (nombre del cliente)\n- `Email` (correo del cliente) - **OBLIGATORIO para env√≠o**\n- `Direccion` (direcci√≥n de entrega)\n- `Telefono` (tel√©fono de contacto)\n- `Producto` (descripci√≥n del producto)\n- `Cantidad` (cantidad solicitada)\n- `PrecioUnitario` (precio por unidad)\n- `Total` (importe total)\n- `Observaciones` (notas adicionales)\n- `Attachments` (se actualizar√° autom√°ticamente)\n- `Estado` (se actualizar√° autom√°ticamente)\n- `NumeroAlbaran` (se asignar√° autom√°ticamente)\n- `FechaAlbaran` (se asignar√° autom√°ticamente)\n\n**üí° CONSEJO:** Usa el campo `Created` como campo de fecha autom√°tica",
        "height": 480,
        "width": 496
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        880,
        -528
      ],
      "id": "45c6f0d6-3b2d-443a-abf8-675be9ea39b2",
      "name": "Campos de Airtable"
    },
    {
      "parameters": {
        "content": "## üîÑ FUNCIONAMIENTO DEL FLUJO\n\n**‚úÖ VALIDADO Y LISTO PARA USAR**\n\n**Paso 1:** Trigger cada minuto busca nuevas filas\n**Paso 2:** Verifica si hay registros creados en los √∫ltimos 2 minutos\n**Paso 3:** Si es nuevo, genera contenido HTML del albar√°n\n**Paso 4:** Crea documento en Google Docs\n**Paso 5:** Mueve el documento a carpeta espec√≠fica\n**Paso 6:** Env√≠a albar√°n por email al cliente\n**Paso 7:** Actualiza el registro original con el enlace\n\n**‚ö° AUTOMATIZACI√ìN COMPLETA:** \nDesde nueva fila ‚Üí Albar√°n creado ‚Üí Email enviado ‚Üí Registro actualizado\n\n**üõ°Ô∏è VALIDACIONES REALIZADAS:**\n- Estructura del flujo ‚úÖ\n- Conexiones entre nodos ‚úÖ\n- Expresiones de n8n ‚úÖ\n- Configuraciones de nodos ‚úÖ",
        "height": 480,
        "width": 432
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1408,
        -528
      ],
      "id": "28aebf26-8831-4a69-bec1-a2039df1affc",
      "name": "Funcionamiento"
    },
    {
      "parameters": {
        "content": "## üõ†Ô∏è PERSONALIZACI√ìN AVANZADA\n\n**Modifica el nodo 'Generar contenido del albar√°n' para:**\n- Cambiar el dise√±o del albar√°n\n- A√±adir tu logo empresarial\n- Incluir m√°s campos de datos\n- Modificar el formato del n√∫mero de albar√°n\n\n**Ajusta el trigger para:**\n- Cambiar frecuencia (cada 5 min, cada hora, etc.)\n- Usar webhook en lugar de polling\n\n**Personaliza el email:**\n- Modificar plantilla del mensaje\n- A√±adir firma corporativa\n- Cambiar formato del adjunto\n\n**üö® PARA PRODUCCI√ìN A√ëADIR:**\n- Manejo de errores en nodos cr√≠ticos\n- Logging de actividades\n- Notificaciones de fallos\n- Backup de datos importantes",
        "height": 512,
        "width": 464
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1872,
        -528
      ],
      "id": "11053df2-e111-4747-8de3-958b79e481ec",
      "name": "Personalizaci√≥n"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-08-11T08:49:21.000Z",
  "versionId": "7279caf6-de50-4728-a62e-de8b67a0c2d6"
}